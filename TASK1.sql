create DATABASE TASK1;
USE TASK1;

CREATE TABLE CUSTOMERS (
CUSTOMERID INT PRIMARY KEY,
NAME varchar(50),
EMAIL VARCHAR(50),
ADDRESS VARCHAR(50)
);

INSERT INTO Customers VALUES
(1,'Amit','amit@gmail.com','Rajkot'),
(2,'Neha','neha@gmail.com','Morbi'),
(3,'Rahul','rahul@gmail.com','Ahmedabad'),
(4,'Pooja','pooja@gmail.com','Surat'),
(5,'Alice','alice@gmail.com','Baroda');

-- 1
SELECT * FROM CUSTOMERS ;

-- 2
UPDATE CUSTOMERS
SET ADDRESS = "JAMNAGAR" 
WHERE CUSTOMERID = 2;

-- 3
DELETE FROM CUSTOMERS WHERE CUSTOMERID = 4;

-- 4
SELECT * FROM CUSTOMERS WHERE NAME = "ALICE";

CREATE TABLE ORDERS (
ORDERID INT PRIMARY KEY,
CUSTOMERID INT,
ORDERDATE DATE,
TOTALAMOUNT int,
FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMERS(CUSTOMERID)
);


INSERT INTO Orders VALUES
(101,1,'2024-12-01',2500),
(102,2,'2024-12-10',1800),
(103,3,'2024-11-25',3200),
(104,1,'2024-12-20',1500),
(105,5,'2024-12-28',4200);


-- 1
SELECT * FROM ORDERS ;

-- 2
SELECT * FROM ORDERS WHERE CUSTOMERID = 1;

-- 3
UPDATE ORDERS 
SET TOTALAMOUNT = 2700
WHERE ORDERID = 101;

-- 4
DELETE FROM ORDERS 
WHERE ORDERID = 104;

-- 5
SELECT * FROM ORDERS
WHERE ORDERDATE >= current_date() - INTERVAL 30 DAY;

-- 6
SELECT MAX(TOTALAMOUNT),
MIN(TOTALAMOUNT),
AVG(TOTALAMOUNT) 
FROM ORDERS;

CREATE TABLE PRODUCTS(
PRODUCTID INT PRIMARY KEY,
PRODUCTNAME VARCHAR(50),
PRICE INT,
STOCK int
);

INSERT INTO Products VALUES
(201,'Keyboard',700,15),
(202,'Mouse',400,0),
(203,'Monitor',5500,8),
(204,'Pendrive',600,25),
(205,'Headphone',1200,5);

-- 1
SELECT * FROM PRODUCTS;

-- 2
SELECT * FROM PRODUCTS
ORDER BY PRICE DESC;

-- 3 
SELECT * FROM PRODUCTS
WHERE PRICE BETWEEN 5000 AND 2000;

-- 4
UPDATE PRODUCTS 
SET PRICE = 650 
WHERE PRODUCTID = 204;

-- 5
DELETE FROM PRODUCT WHERE STOCK = 0;

-- 6
SELECT COUNT(*) FROM PRODUCTS;


CREATE TABLE ORDERDETAILS (
ORDERDETAILID INT PRIMARY KEY,
ORDERID INT,
PRODUCTID INT,
QUANTITY INT,
SUBTOTAL INT,
FOREIGN KEY (ORDERID) REFERENCES ORDERS(ORDERID),
FOREIGN KEY (PRODUCTID) REFERENCES PRODUCTS(PRODUCTID)
);

INSERT INTO OrderDetails VALUES
(1,101,201,2,1400),
(2,101,204,1,600),
(3,102,205,1,1200),
(4,103,203,1,5500),
(5,105,201,3,2100);

-- 1
SELECT * FROM ORDERDETAILS;

-- 2
SELECT * FROM ORDERDETAILS WHERE ORDERID = 101;

-- 3
SELECT SUM(SUBTOTAL) FROM ORDERDETAILS;

-- 4
SELECT PRODUCTID , 
SUM(QUANTITY) AS TOTALQTY 
FROM ORDERDETAILS
group by PRODUCTID
ORDER BY TOTALQTY DESC
LIMIT 3;

-- 5


SELECT c.Name, o.OrderID, o.TotalAmount
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID;










 
